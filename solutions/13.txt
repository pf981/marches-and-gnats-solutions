INIT | PLACE_S_THEN_SEEK_RIGHT_APPEND_E | L
PLACE_S_THEN_SEEK_RIGHT_APPEND_E _ SEEK_RIGHT_AND_APPEND_E S R
SEEK_RIGHT_AND_APPEND_E | SEEK_RIGHT_AND_APPEND_E | R
SEEK_RIGHT_AND_APPEND_E , SEEK_RIGHT_AND_APPEND_E , R
SEEK_RIGHT_AND_APPEND_E _ CHECK_IF_EMPTY E L

CHECK_IF_EMPTY | NON_EMPTY | L
CHECK_IF_EMPTY _ CHECK_IF_EMPTY _ L
CHECK_IF_EMPTY , FIND_E_THEN_APPEND_COMMA _ R

CHECK_IF_EMPTY S POP_COMMA S R
POP_COMMA _ POP_COMMA _ R
POP_COMMA , FIND_E_THEN_APPEND_COMMA _ R

POP_COMMA E REMOVE_S_THEN_HALT _ L
REMOVE_S_THEN_HALT _ REMOVE_S_THEN_HALT _ L
REMOVE_S_THEN_HALT S HALT _ L

NON_EMPTY | NON_EMPTY | L
NON_EMPTY _ NON_EMPTY _ L
NON_EMPTY , CHECK_IF_EMPTY , L
NON_EMPTY S POP_ALL_FIND_NONEMPTY S R

POP_ALL_FIND_NONEMPTY _ POP_ALL_FIND_NONEMPTY _ R
POP_ALL_FIND_NONEMPTY | POP_ALL | R
POP_ALL | POP_ALL | R
POP_ALL _ POP_THEN_SEEK_COMMA_THEN_POP_ALL _ L
POP_ALL E POP_THEN_SEEK_COMMA_THEN_POP_ALL E L
POP_ALL , POP_THEN_SEEK_COMMA_THEN_POP_ALL , L
POP_THEN_SEEK_COMMA_THEN_POP_ALL | SEEK_COMMA_THEN_POP_ALL _ R
SEEK_COMMA_THEN_POP_ALL _ SEEK_COMMA_THEN_POP_ALL _ R
SEEK_COMMA_THEN_POP_ALL , POP_ALL , R
SEEK_COMMA_THEN_POP_ALL E SEEK_RIGHT_APPEND E R

SEEK_RIGHT_APPEND | SEEK_RIGHT_APPEND | R
SEEK_RIGHT_APPEND , SEEK_RIGHT_APPEND , R
SEEK_RIGHT_APPEND _ FIND_E_THEN_CHECK_IF_EMPTY | L

FIND_E_THEN_APPEND_COMMA _ FIND_E_THEN_APPEND_COMMA _ R
FIND_E_THEN_APPEND_COMMA , FIND_E_THEN_APPEND_COMMA , R
FIND_E_THEN_APPEND_COMMA | FIND_E_THEN_APPEND_COMMA | R
FIND_E_THEN_APPEND_COMMA E APPEND_COMMA E R
APPEND_COMMA | APPEND_COMMA | R
APPEND_COMMA , APPEND_COMMA , R
APPEND_COMMA _ COPY_PREV_MARK_X , L
COPY_PREV_MARK_X X COPY_PREV_MARK_X X L
COPY_PREV_MARK_X | COPY_PREV_APPEND X R
COPY_PREV_MARK_X , COPY_PREV_UNDO_XS , R
COPY_PREV_MARK_X E COPY_PREV_UNDO_XS E R
COPY_PREV_UNDO_XS X COPY_PREV_UNDO_XS | R
COPY_PREV_UNDO_XS , FIND_E_THEN_CHECK_IF_EMPTY , L
COPY_PREV_APPEND | COPY_PREV_APPEND | R
COPY_PREV_APPEND , COPY_PREV_APPEND , R
COPY_PREV_APPEND X COPY_PREV_APPEND X R
COPY_PREV_APPEND _ FIND_COMMA_THEN_COPY_PREV_MARK_X | L
FIND_COMMA_THEN_COPY_PREV_MARK_X | FIND_COMMA_THEN_COPY_PREV_MARK_X | L
FIND_COMMA_THEN_COPY_PREV_MARK_X , COPY_PREV_MARK_X , L

FIND_E_THEN_CHECK_IF_EMPTY | FIND_E_THEN_CHECK_IF_EMPTY | L
FIND_E_THEN_CHECK_IF_EMPTY , FIND_E_THEN_CHECK_IF_EMPTY , L
FIND_E_THEN_CHECK_IF_EMPTY E CHECK_IF_EMPTY E L
